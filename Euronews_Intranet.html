<!DOCTYPE html> 
<html lang="sq" class="scroll-smooth">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Euronews Albania • Intranet (SPA)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            brand: { DEFAULT: '#0172F0', 50:'#e8f2ff',100:'#d6e8ff',600:'#0a63e8',700:'#084ec0',900:'#032a6a' },
            accent: { DEFAULT:'#00b6ff' }
          },
          boxShadow:{ soft:'0 6px 24px rgba(0,0,0,0.08)' },
          fontFamily:{ sans:["Inter","system-ui","Segoe UI","Roboto","Helvetica","Arial","sans-serif"] }
        }
      }
    };
  </script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
</head>
<body class="bg-gradient-to-b from-slate-50 to-slate-100 dark:from-slate-950 dark:to-slate-900 text-slate-800 dark:text-slate-100 font-sans">
  <!-- Header -->
  <header class="sticky top-0 z-40 backdrop-blur supports-[backdrop-filter]:bg-white/60 dark:supports-[backdrop-filter]:bg-slate-900/60 shadow">
    <div class="bg-gradient-to-r from-brand to-accent text-white">
      <div class="max-w-7xl mx-auto px-4 py-3 flex items-center justify-between gap-4">
        <div class="flex items-center gap-3">
          <span class="inline-flex h-8 w-8 rounded-full bg-white/95 ring-4 ring-white/20"></span>
          <div>
            <div class="text-base font-extrabold tracking-tight">Euronews Albania • Intranet</div>
            <div class="text-xs uppercase opacity-90">Sales & Field Hub</div>
          </div>
        </div>
        <nav class="hidden md:flex items-center gap-4 text-sm">
          <a href="#home" class="hover:underline">Ballina</a>
          <a href="#section/leads" class="hover:underline">Baza e Bizneseve</a>
          <a href="#vip" class="hover:underline">Klientë VIP</a>
          <a href="#helpdesk" class="hover:underline">Helpdesk</a>
        </nav>
        <button id="themeToggle" class="hidden md:inline-flex items-center gap-2 rounded-lg bg-white/20 px-3 py-2 text-sm font-semibold hover:bg-white/30">
          Temë
        </button>
      </div>
    </div>
  </header>

  <main id="app" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-6">
    <!-- DASHBOARD / HOME -->
    <section id="view-home" class="space-y-6">
      <div class="grid md:grid-cols-4 gap-4">
        <a href="#section/skripte" class="group rounded-2xl border border-slate-200/70 dark:border-slate-800 bg-white/80 dark:bg-slate-900/70 p-5 shadow-soft hover:shadow">
          <div class="text-sm opacity-70">Modul</div>
          <div class="mt-1 text-lg font-semibold">Skripte</div>
          <div class="mt-3 text-xs opacity-60">3 skripte të miratuara</div>
        </a>
        <a href="#section/procedurat" class="group rounded-2xl border border-slate-200/70 dark:border-slate-800 bg-white/80 dark:bg-slate-900/70 p-5 shadow-soft hover:shadow">
          <div class="text-sm opacity-70">Modul</div>
          <div class="mt-1 text-lg font-semibold">Procedurat</div>
          <div class="mt-3 text-xs opacity-60">SOP & eskalime</div>
        </a>
        <a href="#section/paketat" class="group rounded-2xl border border-slate-200/70 dark:border-slate-800 bg-white/80 dark:bg-slate-900/70 p-5 shadow-soft hover:shadow">
          <div class="text-sm opacity-70">Modul</div>
          <div class="mt-1 text-lg font-semibold">Paketa & Ofertat</div>
          <div class="mt-3 text-xs opacity-60">Konfigurime & çmime</div>
        </a>
        <a href="#section/materiale" class="group rounded-2xl border border-slate-200/70 dark:border-slate-800 bg-white/80 dark:bg-slate-900/70 p-5 shadow-soft hover:shadow">
          <div class="text-sm opacity-70">Modul</div>
          <div class="mt-1 text-lg font-semibold">Materiale</div>
          <div class="mt-3 text-xs opacity-60">Deck, case studies, logo</div>
        </a>
      </div>

      <!-- Njoftime -->
      <section id="njoftime" class="rounded-2xl bg-white/80 dark:bg-slate-900/70 border border-slate-200/70 dark:border-slate-800 shadow-soft p-4">
        <div class="flex items-center justify-between">
          <h2 class="text-base font-semibold">Njoftime</h2>
          <button id="addAnnBtn" class="rounded-lg bg-brand px-3 py-1.5 text-xs font-semibold text-white hover:bg-brand-600">+ Shto</button>
        </div>
        <ul class="mt-3 space-y-2 text-sm" id="annList">
          <!-- mbushet nga API kur të kesh backend -->
        </ul>
      </section>

      <!-- Baza e Bizneseve (shkurt) -->
      <section id="leads" class="rounded-2xl bg-white/80 dark:bg-slate-900/70 border border-slate-200/70 dark:border-slate-800 shadow-soft p-4">
        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2">
          <h2 class="text-base font-semibold">Baza e Bizneseve</h2>
          <div class="flex gap-2">
            <input id="searchBiz" class="rounded-lg border border-slate-200/70 dark:border-slate-800 bg-white dark:bg-slate-900 px-3 py-2 text-sm" placeholder="Kërko biznes…">
            <a href="#section/leads" class="rounded-lg bg-slate-100 dark:bg-slate-800 px-3 py-2 text-sm">Hap të plotë</a>
          </div>
        </div>
        <div class="overflow-x-auto mt-3">
          <table class="min-w-full text-sm" id="bizTable">
            <thead class="bg-slate-50 dark:bg-slate-800/60"><tr>
              <th class="text-left p-2">Biznesi</th><th class="text-left p-2">Kontakti</th><th class="text-left p-2">Tel</th><th class="text-left p-2">Status</th><th class="text-left p-2">Hapi tjetër</th><th class="text-left p-2">Agjenti</th><th class="text-left p-2">Rikthim</th><th class="text-left p-2">Veprime</th>
            </tr></thead>
            <tbody>
              <!-- mbushet nga API -->
            </tbody>
          </table>
        </div>
      </section>
    </section>

    <!-- MODULE VIEW (faqe të dedikuara) -->
    <section id="module" class="hidden space-y-4">
      <div id="subnav" class="no-scrollbar overflow-x-auto flex gap-2 p-2 rounded-xl bg-white/70 dark:bg-slate-900/70 border border-slate-200/70 dark:border-slate-800 shadow-soft"></div>
      <div id="moduleContent" class="rounded-2xl bg-white/90 dark:bg-slate-900/80 border border-slate-200/70 dark:border-slate-800 shadow-soft p-6 min-h-[40vh]"></div>
    </section>

    <!-- VIP & Helpdesk (aksesueshme nga header) -->
    <section id="vip" class="rounded-2xl bg-white/80 dark:bg-slate-900/70 border border-slate-200/70 dark:border-slate-800 shadow-soft p-4">
      <div class="flex items-center justify-between mb-2">
        <h2 class="text-base font-semibold">Klientë VIP</h2>
        <div class="text-xs text-slate-500">SLA: ≤ 2h • prioritet i lartë</div>
      </div>
      <div class="overflow-x-auto">
        <table class="min-w-full text-sm border" id="vipTable">
          <thead class="bg-slate-100">
            <tr><th class="p-2 text-left">Klienti</th><th class="p-2 text-left">Account Manager</th><th class="p-2 text-left">Shpenzim (30d)</th><th class="p-2 text-left">Kontrata</th><th class="p-2 text-left">Rikthim</th><th class="p-2 text-left">Status</th></tr>
          </thead>
          <tbody>
            <tr class="border-t"><td>Green Hotel</td><td>Erisa</td><td>€7,500</td><td>06/2025–09/2025</td><td>2025-08-25</td><td><span class="text-green-600">Aktiv</span></td></tr>
            <tr class="border-t"><td>AutoParts Shpk</td><td>Ardit</td><td>€5,200</td><td>07/2025–10/2025</td><td>2025-09-01</td><td><span class="text-yellow-600">Rinegocim</span></td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <section id="helpdesk" class="rounded-2xl bg-white/80 dark:bg-slate-900/70 border border-slate-200/70 dark:border-slate-800 shadow-soft p-4">
      <h2 class="text-base font-semibold mb-3">IT Helpdesk</h2>
      <form class="space-y-3" onsubmit="event.preventDefault(); alert('Kërkesa u dërgua (demo).');">
        <div class="grid sm:grid-cols-2 gap-2">
          <input type="text" placeholder="Emri & Mbiemri" class="w-full border rounded px-3 py-2 text-sm" required>
          <input type="email" placeholder="Emaili i punës" class="w-full border rounded px-3 py-2 text-sm" required>
        </div>
        <div class="grid sm:grid-cols-2 gap-2">
          <select class="w-full border rounded px-3 py-2 text-sm"><option>Sistemi CRM</option><option>VPN / Internet</option><option>Laptop & Software</option><option>Tjetër</option></select>
          <input type="text" placeholder="Subjekti" class="w-full border rounded px-3 py-2 text-sm" required>
        </div>
        <textarea placeholder="Përshkruaj problemin…" class="w-full border rounded px-3 py-2 text-sm"></textarea>
        <button class="bg-brand text-white px-4 py-2 rounded text-sm">Dërgo</button>
      </form>
    </section>
  </main>

  <footer class="py-8 mt-6 border-t border-slate-200/70 dark:border-slate-800 text-sm text-center">
    © Euronews Albania — Intranet për Telesales & Terren
  </footer>

  <script>
    const API = "http://localhost:3001/api"; // ndrysho sipas nevojës

    // Dark mode toggle
    const themeBtn = document.getElementById('themeToggle');
    if(themeBtn){ themeBtn.addEventListener('click', ()=> document.documentElement.classList.toggle('dark')); }

    // Router: #home, #section/skripte, #section/procedurat, #section/paketat, #section/materiale, #section/leads
    const routes = {
      'home': () => showHome(),
      'section/skripte': () => openModule('Skripte', [
        { id:'script-1', title:'Skript – Hyrje (Cold Call)', content:`<h2 class='text-xl font-bold mb-2'>Skript – Hyrje</h2><p class='text-sm opacity-80'>Teksti i skriptit hyrës, hapja dhe kualifikimi i shpejtë…</p>` },
        { id:'script-2', title:'Skript – Objektime', content:`<h2 class='text-xl font-bold mb-2'>Skript – Objektime</h2><ul class='list-disc ml-5 text-sm'><li>Është e shtrenjtë…</li><li>S'jemi gati…</li><li>Nuk sjell klientë…</li></ul>` },
        { id:'script-3', title:'Skript – Mbyllje', content:`<h2 class='text-xl font-bold mb-2'>Skript – Mbyllje</h2><p class='text-sm'>CTA për takim/offertë, recap dhe next steps…</p>` }
      ]),
      'section/procedurat': () => openModule('Procedurat', [
        { id:'sop-1', title:'SOP 01 – Telefonata e ftohtë', content:`<h2 class='text-xl font-bold mb-2'>SOP 01</h2><ol class='list-decimal ml-5 space-y-1 text-sm'><li>Hapja + arsyeja</li><li>Kualifikimi</li><li>Vlera</li><li>CTA</li><li>CRM</li></ol>` },
        { id:'sop-2', title:'SOP 02 – Ofertimi', content:`<h2 class='text-xl font-bold mb-2'>SOP 02</h2><p class='text-sm'>Brief → paketë → miratim → dërgim → follow-up 48h.</p>` },
        { id:'sop-3', title:'SOP 03 – Eskalime & VIP SLA', content:`<h2 class='text-xl font-bold mb-2'>SOP 03</h2><p class='text-sm'>Koha e përgjigjes, rolet dhe hapat e eskalimit.</p>` }
      ]),
      'section/paketat': () => openModule('Paketa & Ofertat', [
        { id:'pack-1', title:'Starter', content:`<h2 class='text-xl font-bold mb-2'>Pako Starter</h2><ul class='list-disc ml-5 text-sm'><li>20 spot/javë</li><li>09:00–22:00</li><li>1× post social</li></ul><div class='mt-3 font-bold'>€1,200</div>` },
        { id:'pack-2', title:'Growth', content:`<h2 class='text-xl font-bold mb-2'>Pako Growth</h2><ul class='list-disc ml-5 text-sm'><li>40 spot/javë</li><li>08:00–23:00</li><li>2× post social</li></ul><div class='mt-3 font-bold'>€2,200</div>` },
        { id:'pack-3', title:'Prime', content:`<h2 class='text-xl font-bold mb-2'>Pako Prime</h2><ul class='list-disc ml-5 text-sm'><li>70 spot/javë</li><li>07:00–24:00</li><li>3× post social + intervistë</li></ul><div class='mt-3 font-bold'>€3,900</div>` }
      ]),
      'section/materiale': () => openModule('Materiale', [
        { id:'mat-1', title:'Deck prezantimi', content:`<h2 class='text-xl font-bold mb-2'>Deck prezantimi</h2><p class='text-sm'>Link ose preview i prezantimit (PPTX).</p>` },
        { id:'mat-2', title:'Case Studies', content:`<h2 class='text-xl font-bold mb-2'>Case Studies</h2><p class='text-sm'>Rezultate dhe shembuj suksesi.</p>` },
        { id:'mat-3', title:'Asete & Udhëzues', content:`<h2 class='text-xl font-bold mb-2'>Asete & Udhëzues</h2><p class='text-sm'>Logo, udhëzues brandi, template ofertash.</p>` }
      ]),
      'section/leads': () => openModule('Baza e Bizneseve', [
        { id:'leads-all', title:'Të gjitha bizneset', content: document.getElementById('leads')?.outerHTML || "<p class='text-sm'>S’ka të dhëna.</p>" }
      ])
    };

    function router(){
      const hash = location.hash.replace('#','') || 'home';
      if(routes[hash]) routes[hash]();
      else if(hash.startsWith('section/')) { const base = hash.split('?')[0]; routes[base]?.(); }
      else routes['home']();
      window.scrollTo({top:0, behavior:'smooth'});
    }

    function showHome(){
      document.getElementById('view-home').classList.remove('hidden');
      document.getElementById('module').classList.add('hidden');
    }

    // Ndërfaqja e modulit me nënopsione horizontale (header)
    function openModule(title, items){
      const viewHome = document.getElementById('view-home');
      const module = document.getElementById('module');
      const subnav = document.getElementById('subnav');
      const content = document.getElementById('moduleContent');

      viewHome.classList.add('hidden');
      module.classList.remove('hidden');

      subnav.innerHTML = items.map((it,i)=>`
        <button data-id="${it.id}"
          class="subbtn whitespace-nowrap rounded-xl border border-slate-200/70 dark:border-slate-800 bg-white/80 dark:bg-slate-900/60 px-4 py-2 text-sm font-semibold hover:border-brand ${i===0?'ring-2 ring-brand/40':''}">
          ${it.title}
        </button>`).join('');

      content.innerHTML = items[0].content;

      subnav.querySelectorAll('.subbtn').forEach(btn => btn.addEventListener('click', ()=>{
        subnav.querySelectorAll('.subbtn').forEach(b=>b.classList.remove('ring-2','ring-brand/40'));
        btn.classList.add('ring-2','ring-brand/40');
        const id = btn.getAttribute('data-id');
        const item = items.find(x=>x.id===id);
        content.innerHTML = item?.content || '';
        content.scrollIntoView({behavior:'smooth'});
      }));
    }

    // Feeds (kur ke backend-in lokal)
    async function loadAnnouncements(){ try{
      const data = await fetch(`${API}/announcements`).then(r=>r.json());
      const ul = document.getElementById('annList'); if(!ul) return;
      ul.innerHTML = data.map(a=>`<li><b>${a.title}</b> · <span class='text-xs opacity-60'>${a.created_at||''}</span>${a.body?`<div class='text-sm opacity-80'>${a.body}</div>`:''}</li>`).join('');
    }catch(e){ /* demo */ } }

    async function loadClients(){ try{
      const data = await fetch(`${API}/clients`).then(r=>r.json());
      const tbody = document.querySelector('#bizTable tbody'); if(!tbody) return;
      tbody.innerHTML = data.map(c=>`<tr class='border-b'>
        <td class='p-2'>${c.name}</td><td class='p-2'>${c.contact||''}</td><td class='p-2'>${c.phone||''}</td>
        <td class='p-2'>${c.status||''}</td><td class='p-2'>${c.next_step||''}</td><td class='p-2'>${c.owner||''}</td><td class='p-2'>${c.follow_up||''}</td>
        <td class='p-2 whitespace-nowrap'><button class='quickBtn text-xs bg-emerald-600 text-white px-2 py-1 rounded'>Takim</button> <button class='quickBtn text-xs bg-amber-600 text-white px-2 py-1 rounded'>Oferta</button></td>
      </tr>`).join('');
    }catch(e){ /* demo */ } }

    // Kërkimi lokal në tabelë
    const searchBiz = document.getElementById('searchBiz');
    if(searchBiz){
      searchBiz.addEventListener('input', ()=>{
        const q = searchBiz.value.toLowerCase();
        document.querySelectorAll('#bizTable tbody tr').forEach(tr=>{
          tr.style.display = tr.innerText.toLowerCase().includes(q)?'':'none';
        });
      });
    }

    // Init
    window.addEventListener('DOMContentLoaded', ()=>{ router(); loadAnnouncements(); loadClients(); });
    window.addEventListener('hashchange', router);
  </script>
</body>
</html>
